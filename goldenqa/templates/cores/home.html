{% extends 'cores/base.html' %}
{% load custom_filters %}

{% block content %}

<style>

  .top-left-buttons {
    position: fixed;
    top: 20px;
    left: 20px;
    display: flex;
    gap: 10px;
    z-index: 9999;
  }

  .top-left-buttons a {
    background: #7b5e57;
    color: #f4ede6;
    padding: 0.55rem 1.2rem;
    border-radius: 12px;
    font-weight: 700;
    font-size: 1rem;
    text-decoration: none;
    box-shadow: 0 4px 10px rgba(123, 94, 87, 0.4);
    transition: background-color 0.3s ease;
  }

  .top-left-buttons a:hover {
    background: #a67b5b;
  }


  body {
    background-color: #f5f1ea;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #4b3b2b;
    margin: 0;
    padding: 0;
  }

  .welcome-section {
    background: #7b5e57;
    color: #f0e6dc;
    padding: 2rem 2.5rem;
    border-radius: 14px;
    box-shadow: 0 8px 20px rgba(123, 94, 87, 0.3);
    max-width: 900px;
    margin: 2rem auto 3rem auto;
    text-align: center;
  }

  .welcome-section h1 {
    font-weight: 700;
    font-size: 2.7rem;
    margin-bottom: 0.5rem;
  }

  .welcome-section p {
    font-size: 1.25rem;
    line-height: 1.5;
    max-width: 650px;
    margin: 0 auto;
  }

  .container {
    max-width: 900px;
    margin: 0 auto 3rem auto;
    padding: 0 1rem;
  }


  .form-section {
    background: #fef9f4;
    border-radius: 12px;
    padding: 1.8rem 2.2rem;
    box-shadow: 0 4px 12px rgba(123, 94, 87, 0.2);
    margin-bottom: 2.5rem;
  }

  .form-section h2 {
    color: #7b5e57;
    font-weight: 600;
    font-size: 1.9rem;
    margin-bottom: 1.3rem;
  }

  .login-warning {
    background: #fff4e1;
    color: #a67b5b;
    border: 1.5px solid #f3c97a;
    border-radius: 12px;
    padding: 1rem 1.3rem;
    font-weight: 600;
    font-size: 1.1rem;
    margin-bottom: 1.5rem;
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .login-warning a {
    color: #a67b5b;
    text-decoration: underline;
    font-weight: 700;
  }

  form div {
    margin-bottom: 1.3rem;
  }

  label {
    font-weight: 600;
    display: block;
    margin-bottom: 0.35rem;
    color: #6b5147;
  }

  input[type="text"], textarea, select {
    width: 100%;
    padding: 0.65rem 0.9rem;
    border: 1.8px solid #c4b59e;
    border-radius: 10px;
    font-size: 1rem;
    color: #5a4236;
    background: #fffefc;
    transition: border-color 0.3s ease;
  }

  input[type="text"]:focus, textarea:focus, select:focus {
    outline: none;
    border-color: #7b5e57;
    box-shadow: 0 0 8px rgba(123, 94, 87, 0.4);
  }

  button[type="submit"] {
    background: linear-gradient(135deg, #7b5e57, #a67b5b);
    border: none;
    padding: 0.85rem 1.8rem;
    color: #f4ede6;
    font-weight: 700;
    font-size: 1.15rem;
    border-radius: 14px;
    cursor: pointer;
    display: inline-flex;
    align-items: center;
    gap: 8px;
    transition: background 0.3s ease;
  }

  button[type="submit"]:hover {
    background: linear-gradient(135deg, #a67b5b, #7b5e57);
  }

  /* Tag butonları */
  .tags-section {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-top: 1rem;
    justify-content: center;
  }

.tag-button {
  width: 130px;
  height: 130px;
  background-color: #d7c9b6;
  border-radius: 0;
  font-weight: 700;
  font-size: 1.1rem;
  color: #5a4236;
  text-decoration: none;
  border: 3px solid transparent;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(123, 94, 87, 0.3);
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  padding: 0;
}


.tag-button:hover {
  background-color: #a67b5b;
  color: #f4ede6;
}

.tag-button.active {
  background-color: #7b5e57;
  color: #f4ede6;
  border-color: #a67b5b;
  box-shadow: 0 0 16px #a67b5b;
}

  .questions-section {
    background: #fef9f4;
    border-radius: 14px;
    padding: 2rem 2.5rem;
    box-shadow: 0 6px 16px rgba(123, 94, 87, 0.25);
  }

  .questions-section h2 {
    color: #7b5e57;
    font-weight: 700;
    margin-bottom: 1.8rem;
    font-size: 2rem;
  }

  .question-card {
    display: block;
    background: #d7c9b6;
    padding: 1.3rem 1.8rem;
    border-radius: 14px;
    margin-bottom: 1.3rem;
    text-decoration: none;
    color: #5a4236;
    box-shadow: 0 3px 8px rgba(123, 94, 87, 0.15);
    transition: background-color 0.3s ease;
  }

  .question-card:hover {
    background: #a67b5b;
    color: #f4ede6;
  }

  .question-content {
    font-size: 1.05rem;
    font-weight: 600;
    margin-bottom: 0.4rem;
    line-height: 1.35;
  }

  .question-meta {
    font-size: 0.9rem;
    color: #6b5147;
    display: flex;
    justify-content: space-between;
    font-style: italic;
  }

  /* Modal */
  #modal-bg {
    background: rgba(75, 59, 43, 0.35) !important;
  }

  #modal-warning {
    background: #fff4e1 !important;
    color: #7b5e57 !important;
    border-color: #f3c97a !important;
  }

  #modal-warning button {
    background: #7b5e57 !important;
    color: #f4ede6 !important;
  }

  #modal-warning button:hover {
    background: #a67b5b !important;
  }
</style>

 <div class="top-left-buttons">
  <a href="{% url 'home' %}">Home</a>
  <a href="{% url 'question_page' %}">All Questions</a>
</div>





<div class="container">
    {% if not selected_tag %}
        <section class="form-section">
            <h2>❓ Ask a Question</h2>
            {% if login_warning %}
                <div class="login-warning" style="display:flex;align-items:center;gap:10px;">
                    <span style="font-size:1.3em;">⚠️</span>
                    <span>You must <a href="{% url 'login' %}" style="font-weight:600;">log in</a> to submit a question.</span>
                </div>
            {% endif %}
            <form method="post">
                {% csrf_token %}
                <div>
                    <label for="{{ form.text.id_for_label }}">Your Question</label>
                    {{ form.text }}
                </div>
                <div>
                    <label for="{{ form.tag.id_for_label }}">Category</label>
                    {{ form.tag }}
                </div>
                <button type="submit">
                    <span>Submit Question</span>
                    <span>→</span>
                </button>
            </form>
        </section>

        <section class="tags-section">
            {% for tag_value, tag_name in all_tags.items %}
                <a href="{% url 'question_page' %}?tag={{ tag_value }}"
                   class="tag-button {% if selected_tag == tag_value %}active{% endif %}">
                    {{ tag_name }}
                </a>
            {% endfor %}
        </section>
    {% endif %}

    {% if selected_tag %}
        <section class="questions-section">
            <h2>{{ all_tags|get_item:selected_tag }} Questions</h2>
            {% if questions %}
                {% for q in questions %}
                    <a class="question-card" href="{% url 'question_detail' q.id %}" {% if not user.is_authenticated %}data-auth="false"{% endif %}>
                        <div class="question-content">
                            {{ q.text|truncatechars:150 }}
                        </div>
                        <div class="question-meta">
                            <span class="question-author">{{ q.user.username }}</span>
                            <span class="question-date">{{ q.created_at|date:"M d, Y" }}</span>
                        </div>
                    </a>
                {% endfor %}
            {% else %}
                <p>No questions found in this category yet. Be the first to ask!</p>
            {% endif %}
        </section>
    {% endif %}
</div>

{% endblock content %}
